name: FootyBitez Long-form Automation

on:
  schedule:
    # Sunday, Tuesday, Thursday, and Saturday at 02:00 UTC
    - cron: '0 2 * * 0,2,4,6'
  workflow_dispatch: # Allow manual trigger

jobs:
  build-and-generate:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout Code
      uses: actions/checkout@v3

    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'

    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r footybitez/requirements.txt
        # Install edge-tts and other dependencies if not in requirements.txt
        pip install edge-tts gtts moviepy pillow requests duckduckgo_search beautifulsoup4 wikipedia google-api-python-client google-auth-oauthlib google-auth-httplib2

    - name: Install FFmpeg
      run: |
        sudo apt-get update
        sudo apt-get install -y ffmpeg

    - name: Run Long-form Automation
      env:
        GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
        GROQ_API_KEY: ${{ secrets.GROQ_API_KEY }}
        PEXELS_API_KEY: ${{ secrets.PEXELS_API_KEY }}
        YOUTUBE_TOKEN_JSON: ${{ secrets.YOUTUBE_TOKEN_JSON }}
        ENABLE_UPLOAD_LONG: "true"
      run: python footybitez/long_main.py
